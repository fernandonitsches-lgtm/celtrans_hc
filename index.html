<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atribui√ß√£o Di√°ria de Setores</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        [class*="lucide-"] {
            display: inline-block;
            width: 1.25rem;
            height: 1.25rem;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function SectorAssignment() {
            const initialPeople = [
                { id: 1, name: 'VITOR RAFAEL MENDES DE OLIVEIRA', cargo: 'ANALISTA OPERACIONAL JUNIOR', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Analista geral opera√ß√£o' },
                { id: 2, name: 'LUCIANO FERREIRA DA SILVA', cargo: 'ANALISTA OPERACIONAL SENIOR', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Analista geral opera√ß√£o' },
                { id: 3, name: 'ANTONIA JAQUELINE LOPES DOS SANTOS', cargo: 'OPERADOR I', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Separa√ß√£o/atendimento' },
                { id: 4, name: 'CAROLINA SIMAO DA COSTA', cargo: 'OPERADOR I', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Faturamento Ovs/ faturamento MKT' },
                { id: 5, name: 'FABIANO JUNIOR DOS SANTOS', cargo: 'ASSISTENTE OPERACIONAL', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Reversa' },
                { id: 6, name: 'IARA PEREIRA DOS SANTOS', cargo: 'OPERADOR I', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Separa√ß√£o/atendimento' },
                { id: 7, name: 'JENYFER LORRAINE DA SILVA BARBOSA', cargo: 'OPERADOR I', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Confer√™ncia/Transporte/expedi√ß√£o' },
                { id: 8, name: 'MARIANA CRISTINA GERALDA DA SILVA ROSA', cargo: 'LIDER', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Lideran√ßa' },
                { id: 9, name: 'THIAGO CONCESSO DE SOUZA', cargo: 'OPERADOR I', area: 'CLARO M√ìVEL (MARIANA)', setor: 'Recebimento/Separa√ß√£o' },
                { id: 10, name: 'GILVAM APARECIDO CARDOSO', cargo: 'OPERADOR ESPECIALIZADO', area: 'EBT (DOUGLAS)', setor: 'Recebimento/Reversa' },
                { id: 11, name: 'MATHEUS PAULA DE SOUZA', cargo: 'OPERADOR II', area: 'EBT (DOUGLAS)', setor: 'Separa√ß√£o/atendimento' },
                { id: 12, name: 'DOUGLAS ALVES DIAS', cargo: 'LIDER', area: 'EBT/OMR (DOUGLAS)', setor: 'Lideran√ßa' },
                { id: 13, name: 'ITALO GABRIEL DOS SANTOS MACHADO', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Expedi√ß√£o' },
                { id: 14, name: 'YASMIN LAISSE ROSA DOS SANTOS', cargo: 'ASSISTENTE OPERACIONAL', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Faturamento' },
                { id: 15, name: 'GERLAN DOS SANTOS LIMA', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Invent√°rio rotativo' },
                { id: 16, name: 'WALISON LUCAS EZEQUIEL ALVES DA SILVA', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Invent√°rio rotativo' },
                { id: 17, name: 'THIAGO GOMES REZENDE', cargo: 'LIDER II', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Lideran√ßa' },
                { id: 18, name: 'MARIANA CAEIRO FERNANDES', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Recebimento' },
                { id: 19, name: 'WELLINGTON FABRICIO DOS SANTOS', cargo: 'OPERADOR II', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Recebimento' },
                { id: 20, name: 'JUVANIA GON√áALVES DOS SANTOS GOMES', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Separa√ß√£o/atendimento' },
                { id: 21, name: 'PABLO DE LIMA MATOS', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Separa√ß√£o/atendimento' },
                { id: 22, name: 'PATRICK JORDAN DE SOUZA', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Separa√ß√£o/atendimento' },
                { id: 23, name: 'JOSMANN ROBERTO COSTA', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Separa√ß√£o/atendimento' },
                { id: 24, name: 'FERNANDO MARTINS RODRIGUES DA SILVA', cargo: 'OPERADOR I', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Separa√ß√£o/atendimento (Udef)' },
                { id: 25, name: 'ANA ELOIZA ALVES SILVA', cargo: 'ASSISTENTE OPERACIONAL', area: 'NET MISCEL√ÇNEA (THIAGO G.)', setor: 'Transporte' },
                { id: 26, name: 'ANA PAULA RODRIGUES SILVA', cargo: 'OPERADOR I', area: 'NET REVERSA (STEPHANY)', setor: 'Recebimento/Consolida√ß√£o acess√≥rio' },
                { id: 27, name: 'DECIA LARA MALVEIRA', cargo: 'OPERADOR II', area: 'NET REVERSA (STEPHANY)', setor: 'listagem' },
                { id: 28, name: 'FLAVIA DE MARILAC SOUSA DE LELIS', cargo: 'OPERADOR I', area: 'NET REVERSA (STEPHANY)', setor: 'listagem' },
                { id: 29, name: 'JACKSON JULIANO GUIMAR√ÉES ARA√öJO', cargo: 'OPERADOR I', area: 'NET REVERSA (STEPHANY)', setor: 'Tratativa' },
                { id: 30, name: 'JOAO GABRIEL DOS SANTOS RIBEIRO', cargo: 'ASSISTENTE OPERACIONAL', area: 'NET REVERSA (STEPHANY)', setor: 'Tratativa' },
                { id: 31, name: 'SHAYENE DOS SANTOS JARDIM', cargo: 'ASSISTENTE OPERACIONAL', area: 'NET REVERSA (STEPHANY)', setor: 'listagem' },
                { id: 32, name: 'STEPHANY RAYANNE RODRIGUES DA CUNHA', cargo: 'LIDER', area: 'NET REVERSA (STEPHANY)', setor: 'Lideran√ßa' },
                { id: 33, name: 'RENATO SOUZA DE JESUS', cargo: 'OPERADOR II', area: 'NET TERMINAL (THIAGO G.)', setor: 'Separa√ß√£o/atendimento' },
                { id: 34, name: 'GUSTAVO SILVA', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Separa√ß√£o acess√≥rio/atendimento' },
                { id: 35, name: 'LILIA CRISTINA PATRICIO DOS SANTOS', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Separa√ß√£o/atendimento' },
                { id: 36, name: 'MARYLLEN TALITA ELEOTERIO TEIXEIRA', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Listagem/recebimento' },
                { id: 37, name: 'PAULA RIBEIRO DIAS', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Separa√ß√£o/atendimento' },
                { id: 38, name: 'THAMIRES VALDEMIRO ALVES', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Listagem/recebimento' },
                { id: 39, name: 'ANDERSON JOS√â RIBEIRO SOUZA', cargo: 'OPERADOR I', area: 'OMR (DOUGLAS)', setor: 'Separa√ß√£o/atendimento/faturamento' },
                { id: 40, name: 'MATHEUS MORAIS DE PAULA', cargo: 'ASSISTENTE OPERACIONAL', area: 'OMR (DOUGLAS)', setor: 'Recebimento/Reversa' },
                { id: 41, name: 'WILLIAM FERNANDO DE OLIVEIRA', cargo: 'ASSISTENTE OPERACIONAL', area: 'OMR (DOUGLAS)', setor: 'Envio para reparo' },
                { id: 42, name: 'ENIL DE PINHO COSTA', cargo: 'OPERADOR DE EMPILHADEIRA', area: 'OPERADOR DE EMPILHADEIRA', setor: 'Operar Empilhadeira' },
            ];

            const setoresUnicos = [...new Set(initialPeople.map(p => p.setor))].sort();

            const [assignments, setAssignments] = useState({});
            const [draggedPerson, setDraggedPerson] = useState(null);
            const [today, setToday] = useState(new Date().toLocaleDateString('pt-BR'));
            const [justificativas, setJustificativas] = useState({});

            useEffect(() => {
                const init = { 'falta': [] };
                setoresUnicos.forEach(setor => {
                    init[setor] = initialPeople.filter(p => p.setor === setor);
                });
                setAssignments(init);
            }, []);

            const handleDragStart = (person, source) => {
                setDraggedPerson({ person, source });
            };

            const handleDragOver = (e) => {
                e.preventDefault();
            };

            const handleDrop = (target) => {
                if (!draggedPerson) return;
                const { person, source } = draggedPerson;
                setAssignments(prev => {
                    const newAssignments = { ...prev };
                    newAssignments[source] = newAssignments[source].filter(p => p.id !== person.id);
                    if (!newAssignments[target]) {
                        newAssignments[target] = [];
                    }
                    newAssignments[target] = [...newAssignments[target], person];
                    return newAssignments;
                });
                setDraggedPerson(null);
            };

            const handleReset = () => {
                const init = { 'falta': [] };
                setoresUnicos.forEach(setor => {
                    init[setor] = initialPeople.filter(p => p.setor === setor);
                });
                setAssignments(init);
                setJustificativas({});
            };

            const handleJustificativa = (personId, texto) => {
                setJustificativas(prev => ({
                    ...prev,
                    [personId]: texto
                }));
            };

            const handleExport = () => {
                let csv = 'Data,Setor,Nome,Cargo,Area\n';
                Object.keys(assignments).forEach(setor => {
                    if (setor !== 'falta') {
                        assignments[setor].forEach(person => {
                            csv += `${today},"${setor}","${person.name}","${person.cargo}","${person.area}"\n`;
                        });
                    }
                });

                if (assignments['falta'] && assignments['falta'].length > 0) {
                    csv += '\n\nFALTAS\nData,Nome,Cargo,Area,Justificativa\n';
                    assignments['falta'].forEach(person => {
                        const justificativa = justificativas[person.id] || '';
                        csv += `${today},"${person.name}","${person.cargo}","${person.area}","${justificativa}"\n`;
                    });
                }

                const element = document.createElement('a');
                element.setAttribute('href', 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv));
                element.setAttribute('download', `atribuicao_${today.replace(/\//g, '-')}.csv`);
                element.style.display = 'none';
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            };

            const totalAtribuido = Object.keys(assignments)
                .filter(k => k !== 'falta')
                .reduce((sum, k) => sum + (assignments[k]?.length || 0), 0);

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6">
                    <div className="max-w-full mx-auto">
                        <div className="flex items-center justify-between mb-8">
                            <div className="flex items-center gap-3">
                                <div className="w-8 h-8 text-blue-600">üìÖ</div>
                                <h1 className="text-3xl font-bold text-slate-800">Atribui√ß√£o Di√°ria de Setores</h1>
                            </div>
                            <div className="text-lg font-semibold text-slate-600">{today}</div>
                        </div>

                        <div className="bg-white rounded-lg shadow-md p-4 mb-6">
                            <div className="flex items-center justify-between">
                                <div className="flex gap-6">
                                    <div className="flex items-center gap-2">
                                        <div className="w-5 h-5 text-blue-600">üë•</div>
                                        <span className="text-slate-700">
                                            <span className="font-semibold text-blue-600">{totalAtribuido}</span> total de pessoas
                                        </span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <div className="w-5 h-5 text-red-600">üë•</div>
                                        <span className="text-slate-700">
                                            <span className="font-semibold text-red-600">{assignments['falta']?.length || 0}</span> falta(s)
                                        </span>
                                    </div>
                                </div>
                                <div className="flex gap-3">
                                    <button
                                        onClick={handleReset}
                                        className="flex items-center gap-2 px-4 py-2 bg-slate-500 text-white rounded-lg hover:bg-slate-600 transition"
                                    >
                                        üîÑ Restaurar
                                    </button>
                                    <button
                                        onClick={handleExport}
                                        className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition"
                                    >
                                        ‚¨áÔ∏è Exportar CSV
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                            {setoresUnicos.map(setor => (
                                <div
                                    key={setor}
                                    onDragOver={handleDragOver}
                                    onDrop={() => handleDrop(setor)}
                                    className="bg-white rounded-lg shadow-md border-2 border-dashed border-blue-200 p-4 min-h-80"
                                >
                                    <h2 className="font-bold text-slate-700 mb-3 pb-2 border-b-2 border-blue-300 text-sm">
                                        {setor} ({assignments[setor]?.length || 0})
                                    </h2>
                                    <div className="space-y-2">
                                        {assignments[setor]?.map(person => (
                                            <div
                                                key={person.id}
                                                draggable
                                                onDragStart={() => handleDragStart(person, setor)}
                                                className="bg-gradient-to-r from-blue-50 to-blue-100 p-3 rounded border-l-4 border-blue-500 cursor-move hover:shadow-md transition"
                                            >
                                                <div className="font-semibold text-slate-800 text-xs">{person.name}</div>
                                                <div className="text-xs text-slate-600 mt-1">{person.cargo}</div>
                                                <div className="text-xs text-slate-500 mt-0.5">{person.area}</div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="bg-red-50 rounded-lg shadow-md border-4 border-dashed border-red-300 p-4">
                            <h2 className="font-bold text-red-700 mb-4 text-lg">‚ùå FALTA ({assignments['falta']?.length || 0})</h2>
                            <div
                                onDragOver={handleDragOver}
                                onDrop={() => handleDrop('falta')}
                                className="mb-4 pb-4 border-b-2 border-red-300"
                            >
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
                                    {assignments['falta']?.map(person => (
                                        <div
                                            key={person.id}
                                            draggable
                                            onDragStart={() => handleDragStart(person, 'falta')}
                                            className="bg-red-100 p-3 rounded border-l-4 border-red-500 cursor-move hover:shadow-md transition"
                                        >
                                            <div className="font-semibold text-red-900 text-sm">{person.name}</div>
                                            <div className="text-xs text-red-700 mt-1">{person.cargo}</div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {assignments['falta']?.length > 0 && (
                                <div className="space-y-4">
                                    <h3 className="font-semibold text-red-700 text-sm">Justificativas:</h3>
                                    {assignments['falta'].map(person => (
                                        <div key={person.id} className="bg-white p-3 rounded">
                                            <label className="block text-xs font-semibold text-slate-700 mb-1">
                                                {person.name}
                                            </label>
                                            <textarea
                                                value={justificativas[person.id] || ''}
                                                onChange={(e) => handleJustificativa(person.id, e.target.value)}
                                                placeholder="Digite a justificativa..."
                                                className="w-full text-xs p-2 border border-red-300 rounded focus:outline-none focus:ring-2 focus:ring-red-500"
                                                rows="2"
                                            />
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<SectorAssignment />, document.getElementById('root'));
    </script>
</body>
</html>
