<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Atribuição Diária de Setores</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Lucide -->
  <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body class="bg-slate-100">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const Calendar = lucide.Calendar;
    const Download = lucide.Download;
    const RotateCcw = lucide.RotateCcw;
    const Users = lucide.Users;

    const SectorAssignment = () => {
      const initialPeople = [
        { id: 1, name: 'VITOR RAFAEL MENDES DE OLIVEIRA', cargo: 'ANALISTA OPERACIONAL JUNIOR', area: 'CLARO MÓVEL (MARIANA)', setor: 'Analista geral operação' },
        { id: 2, name: 'LUCIANO FERREIRA DA SILVA', cargo: 'ANALISTA OPERACIONAL SENIOR', area: 'CLARO MÓVEL (MARIANA)', setor: 'Analista geral operação' },
        { id: 3, name: 'ANTONIA JAQUELINE LOPES DOS SANTOS', cargo: 'OPERADOR I', area: 'CLARO MÓVEL (MARIANA)', setor: 'Separação/atendimento' },
        { id: 4, name: 'CAROLINA SIMAO DA COSTA', cargo: 'OPERADOR I', area: 'CLARO MÓVEL (MARIANA)', setor: 'Faturamento Ovs/ faturamento MKT' },
        { id: 5, name: 'FABIANO JUNIOR DOS SANTOS', cargo: 'ASSISTENTE OPERACIONAL', area: 'CLARO MÓVEL (MARIANA)', setor: 'Reversa' },
        { id: 6, name: 'IARA PEREIRA DOS SANTOS', cargo: 'OPERADOR I', area: 'CLARO MÓVEL (MARIANA)', setor: 'Separação/atendimento' },
        { id: 7, name: 'JENYFER LORRAINE DA SILVA BARBOSA', cargo: 'OPERADOR I', area: 'CLARO MÓVEL (MARIANA)', setor: 'Conferência/Transporte/expedição' },
        { id: 8, name: 'MARIANA CRISTINA GERALDA DA SILVA ROSA', cargo: 'LIDER', area: 'CLARO MÓVEL (MARIANA)', setor: 'Liderança' },
        { id: 9, name: 'THIAGO CONCESSO DE SOUZA', cargo: 'OPERADOR I', area: 'CLARO MÓVEL (MARIANA)', setor: 'Recebimento/Separação' },
        { id: 10, name: 'GILVAM APARECIDO CARDOSO', cargo: 'OPERADOR ESPECIALIZADO', area: 'EBT (DOUGLAS)', setor: 'Recebimento/Reversa' },
        { id: 11, name: 'MATHEUS PAULA DE SOUZA', cargo: 'OPERADOR II', area: 'EBT (DOUGLAS)', setor: 'Separação/atendimento' },
        { id: 12, name: 'DOUGLAS ALVES DIAS', cargo: 'LIDER', area: 'EBT/OMR (DOUGLAS)', setor: 'Liderança' },
        { id: 13, name: 'ITALO GABRIEL DOS SANTOS MACHADO', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Expedição' },
        { id: 14, name: 'YASMIN LAISSE ROSA DOS SANTOS', cargo: 'ASSISTENTE OPERACIONAL', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Faturamento' },
        { id: 15, name: 'GERLAN DOS SANTOS LIMA', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Inventário rotativo' },
        { id: 16, name: 'WALISON LUCAS EZEQUIEL ALVES DA SILVA', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Inventário rotativo' },
        { id: 17, name: 'THIAGO GOMES REZENDE', cargo: 'LIDER II', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Liderança' },
        { id: 18, name: 'MARIANA CAEIRO FERNANDES', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Recebimento' },
        { id: 19, name: 'WELLINGTON FABRICIO DOS SANTOS', cargo: 'OPERADOR II', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Recebimento' },
        { id: 20, name: 'JUVANIA GONÇALVES DOS SANTOS GOMES', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Separação/atendimento' },
        { id: 21, name: 'PABLO DE LIMA MATOS', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Separação/atendimento' },
        { id: 22, name: 'PATRICK JORDAN DE SOUZA', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Separação/atendimento' },
        { id: 23, name: 'JOSMANN ROBERTO COSTA', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Separação/atendimento' },
        { id: 24, name: 'FERNANDO MARTINS RODRIGUES DA SILVA', cargo: 'OPERADOR I', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Separação/atendimento (Udef)' },
        { id: 25, name: 'ANA ELOIZA ALVES SILVA', cargo: 'ASSISTENTE OPERACIONAL', area: 'NET MISCELÂNEA (THIAGO G.)', setor: 'Transporte' },
        { id: 26, name: 'ANA PAULA RODRIGUES SILVA', cargo: 'OPERADOR I', area: 'NET REVERSA (STEPHANY)', setor: 'Recebimento/Consolidação acessório' },
        { id: 27, name: 'DECIA LARA MALVEIRA', cargo: 'OPERADOR II', area: 'NET REVERSA (STEPHANY)', setor: 'Listagem' },
        { id: 28, name: 'FLAVIA DE MARILAC SOUSA DE LELIS', cargo: 'OPERADOR I', area: 'NET REVERSA (STEPHANY)', setor: 'Listagem' },
        { id: 29, name: 'JACKSON JULIANO GUIMARÃES ARAÚJO', cargo: 'OPERADOR I', area: 'NET REVERSA (STEPHANY)', setor: 'Tratativa' },
        { id: 30, name: 'JOAO GABRIEL DOS SANTOS RIBEIRO', cargo: 'ASSISTENTE OPERACIONAL', area: 'NET REVERSA (STEPHANY)', setor: 'Tratativa' },
        { id: 31, name: 'SHAYENE DOS SANTOS JARDIM', cargo: 'ASSISTENTE OPERACIONAL', area: 'NET REVERSA (STEPHANY)', setor: 'Listagem' },
        { id: 32, name: 'STEPHANY RAYANNE RODRIGUES DA CUNHA', cargo: 'LIDER', area: 'NET REVERSA (STEPHANY)', setor: 'Liderança' },
        { id: 33, name: 'RENATO SOUZA DE JESUS', cargo: 'OPERADOR II', area: 'NET TERMINAL (THIAGO G.)', setor: 'Separação/atendimento' },
        { id: 34, name: 'GUSTAVO SILVA', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Separação acessório/atendimento' },
        { id: 35, name: 'LILIA CRISTINA PATRICIO DOS SANTOS', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Separação/atendimento' },
        { id: 36, name: 'MARYLLEN TALITA ELEOTERIO TEIXEIRA', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Listagem/recebimento' },
        { id: 37, name: 'PAULA RIBEIRO DIAS', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Separação/atendimento' },
        { id: 38, name: 'THAMIRES VALDEMIRO ALVES', cargo: 'OPERADOR I', area: 'NET TERMINAL (THIAGO G.)', setor: 'Listagem/recebimento' },
        { id: 39, name: 'ANDERSON JOSÉ RIBEIRO SOUZA', cargo: 'OPERADOR I', area: 'OMR (DOUGLAS)', setor: 'Separação/atendimento/faturamento' },
        { id: 40, name: 'MATHEUS MORAIS DE PAULA', cargo: 'ASSISTENTE OPERACIONAL', area: 'OMR (DOUGLAS)', setor: 'Recebimento/Reversa' },
        { id: 41, name: 'WILLIAM FERNANDO DE OLIVEIRA', cargo: 'ASSISTENTE OPERACIONAL', area: 'OMR (DOUGLAS)', setor: 'Envio para reparo' },
        { id: 42, name: 'ENIL DE PINHO COSTA', cargo: 'OPERADOR DE EMPILHADEIRA', area: 'OPERADOR DE EMPILHADEIRA', setor: 'Operar Empilhadeira' }
      ];

      const setoresUnicos = [...new Set(initialPeople.map(p => p.setor))].sort();
      const [assignments, setAssignments] = useState({});
      const [dragged, setDragged] = useState(null);
      const [today] = useState(new Date().toLocaleDateString('pt-BR'));
      const [justificativas, setJustificativas] = useState({});

      useEffect(() => {
        const init = { falta: [] };
        setoresUnicos.forEach(s => init[s] = initialPeople.filter(p => p.setor === s));
        setAssignments(init);
      }, []);

      const drop = target => {
        if (!dragged) return;
        const { person, source } = dragged;
        setAssignments(prev => {
          const copy = { ...prev };
          copy[source] = copy[source].filter(p => p.id !== person.id);
          copy[target] = [...(copy[target] || []), person];
          return copy;
        });
        setDragged(null);
      };

      const exportCSV = () => {
        let csv = 'Data,Setor,Nome,Cargo,Area\n';
        Object.entries(assignments).forEach(([setor, pessoas]) => {
          if (setor !== 'falta') {
            pessoas.forEach(p =>
              csv += `${today},"${setor}","${p.name}","${p.cargo}","${p.area}"\n`
            );
          }
        });
        const a = document.createElement('a');
        a.href = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);
        a.download = `atribuicao_${today.replace(/\//g, '-')}.csv`;
        a.click();
      };

      return (
        <div className="p-6">
          <h1 className="text-3xl font-bold mb-6 flex gap-2 items-center">
            <Calendar /> Atribuição Diária de Setores — {today}
          </h1>

          <button onClick={exportCSV}
            className="mb-4 px-4 py-2 bg-green-600 text-white rounded flex gap-2">
            <Download /> Exportar CSV
          </button>

          <div className="grid md:grid-cols-3 gap-4">
            {setoresUnicos.map(setor => (
              <div key={setor}
                onDragOver={e => e.preventDefault()}
                onDrop={() => drop(setor)}
                className="bg-white p-3 rounded shadow border-dashed border-2">
                <h2 className="font-bold text-sm mb-2">{setor}</h2>
                {assignments[setor]?.map(p => (
                  <div key={p.id}
                    draggable
                    onDragStart={() => setDragged({ person: p, source: setor })}
                    className="p-2 mb-2 bg-blue-100 rounded cursor-move text-xs">
                    <strong>{p.name}</strong><br />
                    {p.cargo}
                  </div>
                ))}
              </div>
            ))}
          </div>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<SectorAssignment />);
  </script>
</body>
</html>
